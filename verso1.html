<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Virgilio, Aeneis - Liber I (Versos 1-11)</title>
    
    <!-- Google Fonts para la tipografía manuscrita -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=IM+Fell+English:ital@0;1&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS CDN para estilos flexibles y responsivos -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* --- ESTILOS MEDIEVALES PERSONALIZADOS --- */
        
        /* Fondo de la página, simulando una mesa de madera oscura */
        body {
            background-color: #3d2c1d;
            background-image: url('https://www.transparenttextures.com/patterns/wood-pattern.png');
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            padding: 2rem 1rem;
            color: #4a3a2a;
            font-family: 'Helvetica Neue', Arial, sans-serif;
        }

        /* Contenedor principal que simula la hoja del libro */
        .book-page {
            background-color: #fdf5e6; /* Color pergamino */
            background-image: url('https://www.transparenttextures.com/patterns/old-wall.png');
            border: 1px solid #c9b79c;
            box-shadow: 0 8px 25px rgba(0,0,0,0.5);
            max-width: 1200px;
            width: 100%;
            border-radius: 4px;
        }

        /* Tipografía manuscrita para el texto principal y de contexto */
        .textum-classicum, #context-content {
            font-family: 'IM Fell English', 'Georgia', serif;
            font-size: 1.25rem;
            line-height: 1.8;
            color: #5c4d3c;
        }

        /* Estilo de los títulos */
        h1, h2, h3 {
            font-family: 'IM Fell English', 'Georgia', serif;
            font-weight: bold;
            color: #6d4c35;
        }
        #main-title { font-size: 3.5rem; }
        #subtitle { font-size: 1.75rem; }
        #context-title, #text-title, #analysis-title { font-size: 1.5rem; }
        
        /* Estilo para las palabras clickables */
        .verbum {
            cursor: pointer;
            transition: color .2s ease-in-out;
            border-bottom: 1px dotted transparent;
        }
        .verbum:hover {
            background-color: rgba(181, 152, 114, 0.2);
            border-bottom: 1px dotted #8c785c;
        }
        .activus {
            background-color: rgba(181, 152, 114, 0.4) !important;
            color: #3d2c1d !important;
            font-weight: bold;
        }

        /* Números de los versos */
        .verse-number {
            color: #9a3412;
            font-weight: bold;
        }

        /* Línea divisoria ornamental */
        .divider {
            border: 0;
            height: 1px;
            background-image: linear-gradient(to right, rgba(109, 76, 53, 0), rgba(109, 76, 53, 0.75), rgba(109, 76, 53, 0));
            margin: 2rem 0;
        }

        /* --- ESTILOS PARA EL SELECTOR DE IDIOMA --- */
        #language-switcher { display: flex; gap: 0.5rem; padding-bottom: 1rem; }
        .lang-btn { 
            padding: 0.5rem; border: 1px solid #d1c4b0; background-color: #f5eadb; color: #6d4c35;
            border-radius: 0.25rem; cursor: pointer; font-weight: 600; transition: all 0.2s; 
            font-size: 0.875rem; font-family: 'Helvetica Neue', Arial, sans-serif;
        }
        .lang-btn:hover { background-color: #e9dcc9; }
        .lang-btn.active-lang { background-color: #6d4c35; color: #fdf5e6; border-color: #6d4c35; }

        /* --- ESTILOS PARA MENÚS DESPLEGABLES --- */
        details > summary { list-style: none; }
        details > summary::-webkit-details-marker { display: none; }
        details > summary::before { content: '▶'; margin-right: 0.5rem; font-size: 0.8em; transition: transform 0.2s; color: #8c785c;}
        details[open] > summary { color: #3d2c1d; }
        details[open] > summary::before { transform: rotate(90deg); }
        details .details-content { padding-left: 1.2rem; margin-top: 0.5rem; border-left: 1px solid #d1c4b0; }
        #marginalia-contentus .text-2xl { color: #6d4c35; }
        #marginalia-contentus .text-lg { color: #8c785c; }
        #marginalia-contentus .text-sm { color: #5c4d3c; }

        /* --- LAYOUT RESPONSIVO --- */
        
        /* 1. ESTILOS POR DEFECTO (PANTALLAS VERTICALES / MÓVILES) */
        /* El layout es de una sola columna (vertical) */
        .main-layout { padding: 1.5rem; }
        #marginalia-sinistra { 
            margin-top: 2rem;
            padding-top: 1.5rem;
            border-top: 1px solid #d1c4b0;
        }

        /* 2. ESTILOS PARA PANTALLAS HORIZONTALES / ORDENADOR (a partir de 1024px de ancho) */
        /* El layout se divide en dos columnas: 4/5 para el texto, 1/5 para las notas */
        @media (min-width: 1024px) {
            .main-layout {
                display: grid;
                grid-template-columns: 4fr 1fr;
                gap: 2rem;
                padding: 2.5rem 3rem;
            }
            #marginalia-sinistra {
                /* Se resetean los estilos de móvil */
                margin-top: 0;
                padding-top: 0;
                border-top: none;
                
                /* Se aplican los nuevos estilos de barra lateral */
                position: sticky; /* Para que la barra de notas se quede fija al hacer scroll */
                top: 2.5rem;
                height: calc(100vh - 5rem); /* Altura máxima para que no se salga de la pantalla */
                border-left: 1px solid #d1c4b0;
                padding-left: 2rem;
                overflow-y: auto; /* Permite scroll solo en la barra de notas si el contenido es largo */
            }
        }
    </style>
</head>
<body>
    <div class="book-page">
        <div class="main-layout">
            <!-- Columna principal del texto (4/5 en horizontal) -->
            <div id="textum-principale">
                <header>
                    <div id="language-switcher" class="mb-4">
                        <button data-lang="es" class="lang-btn active-lang">Español</button>
                        <button data-lang="en" class="lang-btn">English</button>
                        <button data-lang="zh" class="lang-btn">中文 (繁體)</button>
                    </div>
                    <p id="author" class="text-sm font-semibold uppercase tracking-wider text-[#8c785c]"></p>
                    <h1 id="main-title" class="mb-2"></h1>
                    <h2 id="subtitle" class=""></h2>
                </header>
                <hr class="divider">
                <section id="introductio" class="mb-10">
                    <h3 id="context-title" class="mb-2"></h3>
                    <p id="context-content" class="text-justify leading-relaxed"></p>
                </section>
                <section id="text-et-analisi">
                    <h3 id="text-title" class="mb-4"></h3>
                    <div id="paragrafus-contentus" class="textum-classicum">
                        <!-- El texto se genera aquí dinámicamente -->
                    </div>
                </section>
            </div>
            <!-- Columna de notas (1/5 en horizontal) -->
            <aside id="marginalia-sinistra">
                <h3 id="analysis-title" class="mb-4">Análisis</h3>
                <div id="marginalia-contentus">
                    <p class="text-[#6d4c35] font-['IM_Fell_English']">Haz clic en una palabra en el texto para ver su análisis.</p>
                </div>
            </aside>
        </div>
        <footer class="text-center py-4 border-t border-[#d1c4b0]">
            <p id="footer-text" class="text-sm text-[#8c785c]"></p>
        </footer>
    </div>

    <script>
        const corpus = {
            "titulus_principalis": "Aeneis",
            "titulus_secundarius": { "es": "Liber Primus: Proemio", "en": "Book One: The Proem", "zh": "卷一: 序言" },
            "auctor": "Publius Vergilius Maro",
            "introductio": {
                "es": { "titulus": "Contexto del Libro Primero", "contentus": "El primer libro de la Eneida, la gran epopeya de Virgilio, comienza con el proemio, donde el poeta invoca a la Musa y declara el tema de su obra: las guerras y el héroe Eneas. Tras la caída de Troya, Eneas navega hacia Italia, un viaje obstaculizado por la ira de la diosa Juno. El libro narra la tempestad provocada por Juno que desvía a los troyanos a las costas de Cartago, la llegada de Eneas, y su encuentro con la reina Dido, con quien forjará una relación trágica." },
                "en": { "titulus": "Context of Book One", "contentus": "The first book of the Aeneid, Virgil's great epic, begins with the proem, where the poet invokes the Muse and declares the theme of his work: wars and the hero Aeneas. After the fall of Troy, Aeneas sails towards Italy, a journey hindered by the wrath of the goddess Juno. The book narrates the storm provoked by Juno that diverts the Trojans to the shores of Carthage, the arrival of Aeneas, and his meeting with Queen Dido, with whom he will forge a tragic relationship." },
                "zh": { "titulus": "第一卷背景", "contentus": "維吉爾的偉大史詩《埃涅阿斯紀》第一卷以序言開篇，詩人在此處呼喚繆斯並宣告其作品主題：戰爭和英雄埃涅阿斯。特洛伊陷落後，埃涅阿斯乘船前往義大利，其旅程因女神朱諾的憤怒而受阻。本卷敘述了朱諾引發的暴風雨，將特洛伊人引向迦太基海岸，埃涅阿斯的到來，以及他與狄多女王的相遇，並將與她建立一段悲劇性的關係。" }
            },
            "textus": {
                "capitula": [
                    { "numerus": 1, "orationes": [ { "original_lat": "Arma virumque cano, Troiae qui primus ab oris", "translationes": { "es": "Canto a las armas y al hombre, quien primero desde las costas de Troya", "en": "I sing of arms and the man, who first from the shores of Troy", "zh": "我歌唱武器和那個人，他首先從特洛伊的海岸" }, "verba": [ {"textus": "Arma", "lemma": "arma", "morphologia": "n., pl., acc.", "syntaxis": "Objeto directo de cano", "translatio": {"es": "armas", "en": "arms", "zh": "武器"}}, {"textus": "virumque", "lemma": "vir", "morphologia": "m., sg., acc. (+ -que)", "syntaxis": "Objeto directo de cano", "translatio": {"es": "y al hombre", "en": "and the man", "zh": "和那個人"}}, {"textus": "cano,", "lemma": "cano", "morphologia": "v., 1ª pers., sg., pres., ind.", "syntaxis": "Verbo principal", "translatio": {"es": "canto", "en": "I sing", "zh": "我歌唱"}}, {"textus": "Troiae", "lemma": "Troia", "morphologia": "f., sg., gen.", "syntaxis": "Genitivo de origen con oris", "translatio": {"es": "de Troya", "en": "of Troy", "zh": "的特洛伊"}}, {"textus": "qui", "lemma": "qui", "morphologia": "pron., m., sg., nom.", "syntaxis": "Sujeto de venit", "translatio": {"es": "quien", "en": "who", "zh": "他"}}, {"textus": "primus", "lemma": "primus", "morphologia": "adj., m., sg., nom.", "syntaxis": "Aposición al sujeto", "translatio": {"es": "el primero", "en": "first", "zh": "首先"}}, {"textus": "ab", "lemma": "ab", "morphologia": "prep.", "syntaxis": "Preposición con oris", "translatio": {"es": "desde", "en": "from", "zh": "從"}}, {"textus": "oris", "lemma": "ora", "morphologia": "f., pl., abl.", "syntaxis": "Ablativo de origen", "translatio": {"es": "costas", "en": "shores", "zh": "海岸"}} ] } ] },
                    { "numerus": 2, "orationes": [ { "original_lat": "Italiam, fato profugus, Laviniaque venit", "translationes": { "es": "a Italia, desterrado por el destino, y a las costas de Lavinio vino,", "en": "to Italy, a fugitive by fate, and to Lavinian shores he came,", "zh": "他因命運而逃亡，來到義大利和拉維尼亞的海岸" }, "verba": [ {"textus": "Italiam,", "lemma": "Italia", "morphologia": "f., sg., acc.", "syntaxis": "Acusativo de dirección", "translatio": {"es": "Italia", "en": "Italy", "zh": "義大利"}}, {"textus": "fato", "lemma": "fatum", "morphologia": "n., sg., abl.", "syntaxis": "Ablativo de causa", "translatio": {"es": "por el destino", "en": "by fate", "zh": "因命運"}}, {"textus": "profugus,", "lemma": "profugus", "morphologia": "adj., m., sg., nom.", "syntaxis": "Aposición a qui", "translatio": {"es": "desterrado", "en": "a fugitive", "zh": "逃亡者"}}, {"textus": "Laviniaque", "lemma": "Lavinius", "morphologia": "adj., f., pl., acc. (+ -que)", "syntaxis": "Adjetivo modificando a litora", "translatio": {"es": "y a Lavinio", "en": "and Lavinian", "zh": "和拉維尼亞的"}}, {"textus": "venit", "lemma": "venio", "morphologia": "v., 3ª pers., sg., perf., ind.", "syntaxis": "Verbo principal", "translatio": {"es": "vino", "en": "came", "zh": "來了"}} ] } ] },
                    { "numerus": 3, "orationes": [ { "original_lat": "litora, multum ille et terris iactatus et alto", "translationes": { "es": "mucho él, agitado por mar y tierra", "en": "shores, much tossed about by lands and on the deep", "zh": "海岸，他曾在陸地和深海中被猛烈地拋擲" }, "verba": [ {"textus": "litora,", "lemma": "litus", "morphologia": "n., pl., acc.", "syntaxis": "Acusativo de dirección", "translatio": {"es": "costas", "en": "shores", "zh": "海岸"}}, {"textus": "multum", "lemma": "multum", "morphologia": "adv.", "syntaxis": "Adverbio modificando a iactatus", "translatio": {"es": "mucho", "en": "much", "zh": "猛烈地"}}, {"textus": "ille", "lemma": "ille", "morphologia": "pron., m., sg., nom.", "syntaxis": "Sujeto enfático", "translatio": {"es": "él", "en": "he", "zh": "他"}}, {"textus": "et", "lemma": "et", "morphologia": "conj.", "syntaxis": "Conjunción", "translatio": {"es": "y", "en": "and", "zh": "和"}}, {"textus": "terris", "lemma": "terra", "morphologia": "f., pl., abl.", "syntaxis": "Ablativo de lugar", "translatio": {"es": "por tierra", "en": "by lands", "zh": "在陸地"}}, {"textus": "iactatus", "lemma": "iacto", "morphologia": "part., m., sg., nom., pf.", "syntaxis": "Participio perfecto, modificando a ille", "translatio": {"es": "agitado", "en": "tossed about", "zh": "被拋擲"}}, {"textus": "et", "lemma": "et", "morphologia": "conj.", "syntaxis": "Conjunción", "translatio": {"es": "y", "en": "and", "zh": "和"}}, {"textus": "alto", "lemma": "altum", "morphologia": "n., sg., abl.", "syntaxis": "Ablativo de lugar", "translatio": {"es": "mar", "en": "deep", "zh": "深海"}} ] } ] },
                    { "numerus": 4, "orationes": [ { "original_lat": "vi superum saevae memorem Iunonis ob iram;", "translationes": { "es": "por la fuerza de los de arriba, a causa de la cruel y memoriosa ira de Juno;", "en": "by the force of the gods, on account of the cruel and mindful wrath of Juno;", "zh": "因為眾神的力量，為了朱諾那殘酷而念念不忘的憤怒；" }, "verba": [ {"textus": "vi", "lemma": "vis", "morphologia": "f., sg., abl.", "syntaxis": "Ablativo de causa", "translatio": {"es": "fuerza", "en": "force", "zh": "力量"}}, {"textus": "superum", "lemma": "superus", "morphologia": "adj., m., pl., gen.", "syntaxis": "Genitivo posesivo", "translatio": {"es": "de los dioses", "en": "of the gods", "zh": "的眾神"}}, {"textus": "saevae", "lemma": "saevus", "morphologia": "adj., f., sg., gen.", "syntaxis": "Adjetivo modificando a Iunonis", "translatio": {"es": "cruel", "en": "cruel", "zh": "殘酷的"}}, {"textus": "memorem", "lemma": "memor", "morphologia": "adj., f., sg., acc.", "syntaxis": "Adjetivo modificando a iram", "translatio": {"es": "memoriosa", "en": "mindful", "zh": "念念不忘的"}}, {"textus": "Iunonis", "lemma": "Iuno", "morphologia": "f., sg., gen.", "syntaxis": "Genitivo posesivo", "translatio": {"es": "de Juno", "en": "of Juno", "zh": "的朱諾"}}, {"textus": "ob", "lemma": "ob", "morphologia": "prep.", "syntaxis": "Preposición con iram", "translatio": {"es": "a causa de", "en": "on account of", "zh": "因為"}}, {"textus": "iram;", "lemma": "ira", "morphologia": "f., sg., acc.", "syntaxis": "Objeto de ob", "translatio": {"es": "ira", "en": "wrath", "zh": "憤怒"}} ] } ] },
                    { "numerus": 5, "orationes": [ { "original_lat": "multa quoque et bello passus, dum conderet urbem,", "translationes": { "es": "y también, habiendo sufrido mucho en la guerra, hasta que fundase la ciudad,", "en": "and also having suffered much in war, until he might found a city,", "zh": "而且在戰爭中遭受了許多苦難，直到他能夠建立一座城市，" }, "verba": [ {"textus": "multa", "lemma": "multum", "morphologia": "n., pl., acc.", "syntaxis": "Objeto directo de passus", "translatio": {"es": "muchas cosas", "en": "many things", "zh": "許多"}}, {"textus": "quoque", "lemma": "quoque", "morphologia": "conj.", "syntaxis": "Conjunción", "translatio": {"es": "también", "en": "also", "zh": "也"}}, {"textus": "et", "lemma": "et", "morphologia": "conj.", "syntaxis": "Conjunción", "translatio": {"es": "y", "en": "and", "zh": "和"}}, {"textus": "bello", "lemma": "bellum", "morphologia": "n., sg., abl.", "syntaxis": "Ablativo de instrumento", "translatio": {"es": "en la guerra", "en": "in war", "zh": "在戰爭中"}}, {"textus": "passus,", "lemma": "patior", "morphologia": "part., m., sg., nom., perf.", "syntaxis": "Participio perfecto, modificando al sujeto (qui)", "translatio": {"es": "habiendo sufrido", "en": "having suffered", "zh": "遭受了"}}, {"textus": "dum", "lemma": "dum", "morphologia": "conj.", "syntaxis": "Conjunción temporal", "translatio": {"es": "hasta que", "en": "until", "zh": "直到"}}, {"textus": "conderet", "lemma": "condo", "morphologia": "v., 3ª pers., sg., imperf., subj.", "syntaxis": "Verbo subordinado a dum", "translatio": {"es": "fundase", "en": "he might found", "zh": "他能夠建立"}}, {"textus": "urbem,", "lemma": "urbs", "morphologia": "f., sg., acc.", "syntaxis": "Objeto directo de conderet", "translatio": {"es": "ciudad", "en": "city", "zh": "城市"}} ] } ] },
                    { "numerus": 6, "orationes": [ { "original_lat": "inferretque deos Latio; genus unde Latinum", "translationes": { "es": "y metiera los dioses en el Lacio; de donde la raza latina", "en": "and might bring his gods into Latium; whence the Latin race", "zh": "並將諸神帶入拉提姆；由此產生了拉丁民族" }, "verba": [ {"textus": "inferretque", "lemma": "infero", "morphologia": "v., 3ª pers., sg., imperf., subj. (+ -que)", "syntaxis": "Verbo subordinado a dum", "translatio": {"es": "y metiera", "en": "and might bring", "zh": "並帶來"}}, {"textus": "deos", "lemma": "deus", "morphologia": "m., pl., acc.", "syntaxis": "Objeto directo de inferret", "translatio": {"es": "dioses", "en": "gods", "zh": "諸神"}}, {"textus": "Latio;", "lemma": "Latium", "morphologia": "n., sg., dat.", "syntaxis": "Dativo de lugar", "translatio": {"es": "en el Lacio", "en": "into Latium", "zh": "進入拉提姆"}}, {"textus": "genus", "lemma": "genus", "morphologia": "n., sg., acc.", "syntaxis": "Objeto de inferret", "translatio": {"es": "raza", "en": "race", "zh": "民族"}}, {"textus": "unde", "lemma": "unde", "morphologia": "adv.", "syntaxis": "Adverbio", "translatio": {"es": "de donde", "en": "whence", "zh": "由此"}}, {"textus": "Latinum", "lemma": "Latinus", "morphologia": "adj., n., sg., acc.", "syntaxis": "Adjetivo modificando a genus", "translatio": {"es": "latina", "en": "Latin", "zh": "拉丁的"}} ] } ] },
                    { "numerus": 7, "orationes": [ { "original_lat": "Albanique patres atque altae moenia Romae.", "translationes": { "es": "los padres albanos y las murallas de la alta Roma.", "en": "the Alban fathers and the walls of high Rome.", "zh": "阿爾巴人的祖先以及高貴羅馬的城牆。" }, "verba": [ {"textus": "Albanique", "lemma": "Albanus", "morphologia": "adj., m., pl., nom. (+ -que)", "syntaxis": "Adjetivo modificando a patres", "translatio": {"es": "y albanos", "en": "and Alban", "zh": "和阿爾巴人的"}}, {"textus": "patres", "lemma": "pater", "morphologia": "m., pl., nom.", "syntaxis": "Sujeto de inferret", "translatio": {"es": "padres", "en": "fathers", "zh": "祖先"}}, {"textus": "atque", "lemma": "atque", "morphologia": "conj.", "syntaxis": "Conjunción", "translatio": {"es": "y", "en": "and", "zh": "和"}}, {"textus": "altae", "lemma": "altus", "morphologia": "adj., f., sg., gen.", "syntaxis": "Adjetivo modificando a Romae", "translatio": {"es": "alta", "en": "high", "zh": "高貴的"}}, {"textus": "moenia", "lemma": "moene", "morphologia": "n., pl., nom.", "syntaxis": "Sujeto de inferret", "translatio": {"es": "murallas", "en": "walls", "zh": "城牆"}}, {"textus": "Romae.", "lemma": "Roma", "morphologia": "f., sg., gen.", "syntaxis": "Genitivo posesivo", "translatio": {"es": "de Roma", "en": "of Rome", "zh": "羅馬的"}} ] } ] },
                    { "numerus": 8, "orationes": [ { "original_lat": "Musa, mihi causas memora, quo numine laeso", "translationes": { "es": "Musa, recuérdame las causas, por qué divinidad ultrajada", "en": "Muse, recall for me the causes, by what divine will having been harmed", "zh": "繆斯，為我回憶這些原因，為了哪位受辱的神祇" }, "verba": [ {"textus": "Musa,", "lemma": "Musa", "morphologia": "f., sg., voc.", "syntaxis": "Vocativo", "translatio": {"es": "Musa", "en": "Muse", "zh": "繆斯"}}, {"textus": "mihi", "lemma": "ego", "morphologia": "pron., dat.", "syntaxis": "Dativo de interés", "translatio": {"es": "para mí", "en": "for me", "zh": "為我"}}, {"textus": "causas", "lemma": "causa", "morphologia": "f., pl., acc.", "syntaxis": "Objeto directo de memora", "translatio": {"es": "causas", "en": "causes", "zh": "原因"}}, {"textus": "memora,", "lemma": "memoro", "morphologia": "v., 2ª pers., sg., pres., imp.", "syntaxis": "Imperativo", "translatio": {"es": "recuérdame", "en": "recall for me", "zh": "為我回憶"}}, {"textus": "quo", "lemma": "quis", "morphologia": "pron., n., sg., abl.", "syntaxis": "Ablativo de causa", "translatio": {"es": "por qué", "en": "by what", "zh": "為了哪位"}}, {"textus": "numine", "lemma": "numen", "morphologia": "n., sg., abl.", "syntaxis": "Ablativo de causa", "translatio": {"es": "divinidad", "en": "divine will", "zh": "神祇"}}, {"textus": "laeso", "lemma": "laedo", "morphologia": "part., n., sg., abl., pf.", "syntaxis": "Participio perfecto, modificando a numine", "translatio": {"es": "ultraja", "en": "having been harmed", "zh": "受辱的"}} ] } ] },
                    { "numerus": 9, "orationes": [ { "original_lat": "quidve dolens regina deum tot volvere casus", "translationes": { "es": "o qué lamentando, la reina de los dioses a dar tantas vueltas al destino", "en": "or what grieving, the queen of the gods to undergo so many chances", "zh": "或為了何事而悲痛，眾神之后讓(他)經歷如此多的變故" }, "verba": [ {"textus": "quidve", "lemma": "quis", "morphologia": "pron., n., sg., acc. (+ -ve)", "syntaxis": "Objeto de dolens", "translatio": {"es": "o qué", "en": "or what", "zh": "或為了何事"}}, {"textus": "dolens", "lemma": "doleo", "morphologia": "part., f., sg., pres.", "syntaxis": "Participio presente, modificando a regina", "translatio": {"es": "lamentando", "en": "grieving", "zh": "悲痛"}}, {"textus": "regina", "lemma": "regina", "morphologia": "f., sg., nom.", "syntaxis": "Sujeto de dolens", "translatio": {"es": "reina", "en": "queen", "zh": "女王"}}, {"textus": "deum", "lemma": "deus", "morphologia": "m., pl., gen.", "syntaxis": "Genitivo posesivo", "translatio": {"es": "de los dioses", "en": "of the gods", "zh": "的眾神"}}, {"textus": "tot", "lemma": "tot", "morphologia": "adj., indecl.", "syntaxis": "Adjetivo indefinido", "translatio": {"es": "tantas", "en": "so many", "zh": "如此多"}}, {"textus": "volvere", "lemma": "volvo", "morphologia": "v., inf., pres.", "syntaxis": "Infinitivo, objeto de dolens", "translatio": {"es": "dar vueltas", "en": "to undergo", "zh": "經歷"}}, {"textus": "casus", "lemma": "casus", "morphologia": "m., pl., acc.", "syntaxis": "Objeto directo de volvere", "translatio": {"es": "desgracias", "en": "chances", "zh": "變故"}} ] } ] },
                    { "numerus": 10, "orationes": [ { "original_lat": "insignem pietate virum, tot adire labores", "translationes": { "es": "a un hombre insigne por su piedad, a ir a tantos trabajos", "en": "a man marked by piety, to approach so many labors", "zh": "一個以虔誠著稱的男人，去面對如此多的苦難" }, "verba": [ {"textus": "insignem", "lemma": "insignis", "morphologia": "adj., m., sg., acc.", "syntaxis": "Adjetivo, modificando a virum", "translatio": {"es": "insigne", "en": "marked", "zh": "著稱的"}}, {"textus": "pietate", "lemma": "pietas", "morphologia": "f., sg., abl.", "syntaxis": "Ablativo de causa", "translatio": {"es": "piedad", "en": "piety", "zh": "虔誠"}}, {"textus": "virum,", "lemma": "vir", "morphologia": "m., sg., acc.", "syntaxis": "Objeto directo de dolens", "translatio": {"es": "hombre", "en": "man", "zh": "男人"}}, {"textus": "tot", "lemma": "tot", "morphologia": "adj., indecl.", "syntaxis": "Adjetivo indefinido", "translatio": {"es": "tantos", "en": "so many", "zh": "如此多"}}, {"textus": "adire", "lemma": "adeo", "morphologia": "v., inf., pres.", "syntaxis": "Infinitivo, objeto de dolens", "translatio": {"es": "ir a", "en": "to approach", "zh": "去面對"}}, {"textus": "labores", "lemma": "labor", "morphologia": "m., pl., acc.", "syntaxis": "Objeto directo de adire", "translatio": {"es": "trabajos", "en": "labors", "zh": "苦難"}} ] } ] },
                    { "numerus": 11, "orationes": [ { "original_lat": "impulerit. Tantaene animis caelestibus irae?", "translationes": { "es": "¿Tan grandes iras hay en las almas celestes?", "en": "pushed. Is there such great wrath in heavenly souls?", "zh": "推動了(他)。天界的靈魂中竟有如此大的憤怒嗎？" }, "verba": [ {"textus": "impulerit.", "lemma": "impello", "morphologia": "v., 3ª pers., sg., perf., subj.", "syntaxis": "Verbo principal", "translatio": {"es": "impulsó", "en": "pushed", "zh": "推動了"}}, {"textus": "Tantaene", "lemma": "tantus", "morphologia": "adj., f., pl., nom. (+ -ne)", "syntaxis": "Adjetivo, interrogativo", "translatio": {"es": "tan grandes", "en": "such great", "zh": "如此大的"}}, {"textus": "animis", "lemma": "animus", "morphologia": "m., pl., dat.", "syntaxis": "Dativo de lugar", "translatio": {"es": "en las almas", "en": "in the souls", "zh": "在靈魂中"}}, {"textus": "caelestibus", "lemma": "caelestis", "morphologia": "adj., m., pl., dat.", "syntaxis": "Adjetivo, modificando a animis", "translatio": {"es": "celestes", "en": "heavenly", "zh": "天界的"}}, {"textus": "irae?", "lemma": "ira", "morphologia": "f., pl., nom.", "syntaxis": "Sujeto", "translatio": {"es": "iras", "en": "wrath", "zh": "憤怒"}} ] } ] }
                ]
            }
        };

        document.addEventListener('DOMContentLoaded', () => {
            if (typeof corpus === 'undefined') {
                console.error("Error: El objeto 'corpus' no está definido.");
                return;
            }

            const mainTitleElem = document.getElementById('main-title');
            const subtitleElem = document.getElementById('subtitle');
            const authorElem = document.getElementById('author');
            const contextTitleElem = document.getElementById('context-title');
            const contextContentElem = document.getElementById('context-content');
            const textTitleElem = document.getElementById('text-title');
            const paragrafusContentusElem = document.getElementById('paragrafus-contentus');
            const marginaliaContentusElem = document.getElementById('marginalia-contentus');
            const footerElem = document.getElementById('footer-text');
            const langSwitcher = document.getElementById('language-switcher');
            
            let currentLang = 'es';

            function renderContent() {
                mainTitleElem.textContent = corpus.titulus_principalis;
                subtitleElem.textContent = corpus.titulus_secundarius[currentLang];
                authorElem.textContent = corpus.auctor;
                
                contextTitleElem.textContent = corpus.introductio[currentLang].titulus;
                contextContentElem.innerHTML = corpus.introductio[currentLang].contentus;
                
                textTitleElem.textContent = currentLang === 'es' ? 'Texto y Análisis' : (currentLang === 'en' ? 'Text and Analysis' : '文本與分析');
                
                buildLatinText();
                
                footerElem.textContent = `© ${new Date().getFullYear()} - Análisis Interactivo.`;
            }

            function buildLatinText() {
                paragrafusContentusElem.innerHTML = ''; 
                corpus.textus.capitula.forEach((versus, versusIndex) => {
                    const p = document.createElement('p');
                    p.className = "mb-6"; 
                    p.innerHTML += `<span class="verse-number mr-2">${versus.numerus}. </span>`; 
                    versus.orationes.forEach((sententia, sententiaIndex) => {
                        const words = sententia.original_lat.split(/(\s+)/);
                        words.forEach(word => {
                            if (!word.trim()) {
                                p.appendChild(document.createTextNode(word));
                                return;
                            }
                            const cleanWord = word.replace(/[,.;:]/g, '');
                            const verbumData = sententia.verba.find(v => v.textus.replace(/[,.;:]/g, '') === cleanWord);

                            if (verbumData) {
                                const span = document.createElement('span');
                                span.textContent = word;
                                span.className = 'verbum';
                                span.dataset.versusIndex = versusIndex;
                                span.dataset.sententiaIndex = sententiaIndex;
                                span.dataset.verbumTextus = verbumData.textus;
                                p.appendChild(span);
                            } else {
                                p.appendChild(document.createTextNode(word));
                            }
                        });
                    });
                    paragrafusContentusElem.appendChild(p);
                });
            }

            function showAnalysis(clickedSpan) {
                const { versusIndex, sententiaIndex, verbumTextus } = clickedSpan.dataset;
                const sententiaData = corpus.textus.capitula[versusIndex].orationes[sententiaIndex];
                const verbumData = sententiaData.verba.find(v => v.textus.replace(/[,.;:]/g, '') === verbumTextus.replace(/[,.;:]/g, ''));
                if (!verbumData) return;

                const palabraTraducida = verbumData.translatio ? verbumData.translatio[currentLang] : 'N/A';
                const oratioTraducida = sententiaData.translationes[currentLang] || 'N/A';

                marginaliaContentusElem.innerHTML = `
                    <div class="space-y-4">
                        <div>
                            <p class="text-2xl textum-classicum font-bold">${verbumData.textus}</p>
                            <p class="text-lg font-semibold mb-2">${palabraTraducida}</p> 
                            <p class="text-sm"><b>Lema:</b> <i>${verbumData.lemma}</i></p>
                            <p class="text-sm"><b>Morfología:</b> ${verbumData.morphologia}</p>
                            <p class="text-sm"><b>Sintaxis:</b> ${verbumData.syntaxis}</p>
                        </div>
                        <hr class="divider" style="margin: 1rem 0;">
                        <details open>
                            <summary class="font-semibold">Traducción del Verso</summary>
                            <div class="details-content mt-2 text-sm">
                                <p>${oratioTraducida}</p>
                            </div>
                        </details>
                    </div>`;
            }
            
            paragrafusContentusElem.addEventListener('click', (e) => {
                if (e.target.classList.contains('verbum')) {
                    document.querySelectorAll('.verbum').forEach(el => el.classList.remove('activus'));
                    e.target.classList.add('activus');
                    showAnalysis(e.target);
                }
            });

            langSwitcher.addEventListener('click', (e) => {
                if (e.target.tagName === 'BUTTON') {
                    const newLang = e.target.dataset.lang;
                    if (newLang !== currentLang) {
                        currentLang = newLang;
                        langSwitcher.querySelectorAll('.lang-btn').forEach(btn => {
                            btn.classList.toggle('active-lang', btn.dataset.lang === newLang);
                        });
                        renderContent();
                        marginaliaContentusElem.innerHTML = `<p class="text-[#6d4c35] font-['IM_Fell_English']">Haz clic en una palabra en el texto para ver su análisis.</p>`;
                    }
                }
            });

            renderContent();
        });
    </script>
</body>
</html>
